--[[
	A program for previewing files in computerCraft
	Note that this will encounter problems if of the 
	first line in a file is to long.

	Hugo Hornquist, 20151122
]]--

/utils/vimfiles/apiloader.loadAPI( "/utils/vimfiles/" )

local args = {...}

-- Check if a file is supplied
if args[1] == nil then
	error("no file selected")
end


-- start main
local args = {...}

local termX, termY = term.getSize()
global.setVar("termX", termX)
global.setVar("termY", termY)


global.setVar("hasChanged", false)

-- TODO check if file is read only
if #args < 1 then
	error("please specify a file")
end

local sPath = shell.resolve( args[1] )
if fs.exists( sPath ) and fs.isDir( sPath ) then
	print( "Cannot edit a directory." )
	return
end
global.setVar("fileName", sPath)



-- what absolute line are selected
global.setVar("currentLine", 1)
global.setVar("currentColumn", 1)
global.setVar("topLine", 1)


local lines = file.read(global.getVar("fileName"))
global.setLines(lines)



screen.redraw()

----

vimode.lessMode()

